/Users/milo/Desktop/Python projects/MLI/MLI Week 2/MLI_week_2_venv/lib/python3.13/site-packages/google/protobuf/internal/well_known_types.py:178: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
Using device: cpu
/Users/milo/Desktop/Python projects/MLI/MLI Week 2/MLI_week_2_venv/lib/python3.13/site-packages/google/protobuf/internal/well_known_types.py:178: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  self.FromDatetime(datetime.datetime.utcnow())
Traceback (most recent call last):
  File "/Users/milo/Desktop/Python projects/MLI/MLI Week 2/D_dual_encoder_finetunehard.py", line 298, in <module>
    maintrain()
    ~~~~~~~~~^^
  File "/Users/milo/Desktop/Python projects/MLI/MLI Week 2/D_dual_encoder_finetunehard.py", line 273, in maintrain
    train_losses, val_losses, best_metrics, QryTower, DocTower = finetune_DualEncoder_on_hardnegatives(
                                                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        train_loader,
        ^^^^^^^^^^^^^
    ...<5 lines>...
        run_name=run_name
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/milo/Desktop/Python projects/MLI/MLI Week 2/D_dual_encoder_finetunehard.py", line 105, in finetune_DualEncoder_on_hardnegatives
    batch_dst_pos = F.cosine_similarity(examples['query_embeddings'], examples['pos_doc_embeddings'], dim=1)
                                        ~~~~~~~~^^^^^^^^^^^^^^^^^^^^
KeyError: 'query_embeddings'
